<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>MCP Â· ACROPAQ</title>
    <link crossorigin href="https://fonts.gstatic.com/" rel="preconnect"/>
    <link as="style" href="https://fonts.googleapis.com/css2?display=swap&family=Inter:wght@400;500;700;900&family=Noto+Sans:wght@400;500;700;900" onload="this.rel='stylesheet'" rel="stylesheet"/>
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <script src="/app/shell.js"></script>
    <style> body{font-family:Inter, "Noto Sans", sans-serif;} .card{background:#181C20;border:1px solid #283039;border-radius:.5rem;} .inp{background:#111418;border:1px solid #283039;color:#fff;border-radius:.375rem;padding:.5rem .75rem;width:100%;} .btn{display:inline-flex;align-items:center;gap:.5rem;border-radius:.5rem;padding:.5rem .75rem;font-weight:500;} .btn-primary{background:#0d7ff2;color:#fff;} .btn-secondary{background:#0f172a;color:#fff;} .tag{background:#0f172a;border:1px solid #283039;border-radius:.375rem;padding:.125rem .375rem;}</style>
  </head>
  <body class="min-h-screen bg-[#111418] text-gray-100">
    <main class="max-w-6xl mx-auto p-6 grid grid-cols-1 lg:grid-cols-3 gap-6">
      <section class="card p-4 lg:col-span-2">
        <div class="flex items-center justify-between mb-3">
          <h2 class="font-semibold text-white">MCP Tools</h2>
          <div class="text-xs text-[#9cabba]">Read-only catalog</div>
        </div>
        <div id="tools" class="space-y-2"></div>
      </section>
      <section class="card p-4">
        <h3 class="font-medium text-white mb-3">Test Tool</h3>
        <div class="grid grid-cols-1 gap-2">
          <div>
            <label class="block text-sm text-gray-400">Tool</label>
            <select id="tool" class="inp"></select>
          </div>
          <div>
            <label class="block text-sm text-gray-400">Params (JSON)</label>
            <textarea id="params" class="inp h-40" placeholder='{"to":"+32..."}'></textarea>
          </div>
          <button id="run" class="btn btn-secondary">Run</button>
          <pre id="out" class="text-sm text-gray-300 whitespace-pre-wrap"></pre>
        </div>
      </section>
    </main>
    <script>
      const el={ tools:document.getElementById('tools'), tool:document.getElementById('tool'), params:document.getElementById('params'), run:document.getElementById('run'), out:document.getElementById('out') };
      let available=[];
      function row(t){ const wrap=document.createElement('div'); wrap.className='p-3 border border-[#283039] rounded'; const title=document.createElement('div'); title.className='font-medium'; title.textContent=t.name; const desc=document.createElement('div'); desc.className='text-xs text-gray-400'; desc.textContent=t.description||''; wrap.appendChild(title); wrap.appendChild(desc); return wrap; }
      async function load(){ const r=await fetch('/api/mcp/tools',{credentials:'include'}); const j=await r.json(); available=j.tools||[]; el.tools.innerHTML=''; available.forEach(t=> el.tools.appendChild(row(t))); el.tool.innerHTML=''; available.forEach(t=>{ const o=document.createElement('option'); o.value=t.name; o.textContent=t.name; el.tool.appendChild(o); }); }
      el.run.onclick = async ()=>{ try{ el.out.textContent=''; const name=el.tool.value; const params=JSON.parse(el.params.value||'{}'); const r=await fetch('/api/mcp/call',{ method:'POST', headers:{'Content-Type':'application/json'}, credentials:'include', body: JSON.stringify({ name, params }) }); const j=await r.json(); el.out.textContent = JSON.stringify(j, null, 2); } catch(e){ el.out.textContent=String(e); } };
      load();
    </script>
  </body>
  </html>
